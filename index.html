<!DOCTYPE html>
<html>
<head>
  <title>Smart Street Light – History Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; margin: 20px; }
    canvas { margin-bottom: 50px; }
  </style>
</head>

<body>

<h2>Zone 1 – Power</h2>
<canvas id="z1Power"></canvas>

<h2>Zone 1 – Current</h2>
<canvas id="z1Current"></canvas>

<h2>Zone 1 – LDR</h2>
<canvas id="z1Ldr"></canvas>

<h2>Zone 1 – Brightness</h2>
<canvas id="z1Brightness"></canvas>

<script>
const BASE_URL =
  "https://idp-eg8-default-rtdb.asia-southeast1.firebasedatabase.app/SmartStreetLight/Z1/history.json";

fetch(BASE_URL)
.then(res => res.json())
.then(history => {

  const labels = [];
  const power = [];
  const current = [];
  const ldr = [];
  const brightness = [];

  for (const ts in history) {
    labels.push(new Date(parseInt(ts)).toLocaleTimeString());
    power.push(history[ts].power);
    current.push(history[ts].current);
    ldr.push(history[ts].ldr);
    brightness.push(history[ts].brightness);
  }

  function makeChart(id, label, data) {
    new Chart(document.getElementById(id), {
      type: "line",
      data: {
        labels: labels,
        datasets: [{
          label: label,
          data: data,
          borderWidth: 2
        }]
      }
    });
  }

  makeChart("z1Power", "Power (W)", power);
  makeChart("z1Current", "Current (A)", current);
  makeChart("z1Ldr", "LDR Value", ldr);
  makeChart("z1Brightness", "Brightness (%)", brightness);

});
</script>

</body>
</html>
